[settings]
experimental = true
lockfile = true

[tools]
go = "latest"
hk = "latest"
pkl = "latest"
prettier = "latest"
"go:golang.org/x/pkgsite/cmd/pkgsite" = "latest"
"go:github.com/oapi-codegen/oapi-codegen/v2/cmd/oapi-codegen" = "latest"

[env]
_.file = '.env'

[tasks.setup]
run = ["mise install", "hk install", "mise lock"]

[tasks.build]
run = "go build ./..."

[tasks.test]
run = "go test ./..."

[tasks.rom-tools]
run = "go run ./cmd/rom-tools"

[tasks.clean]
run = "go clean"

[tasks.check]
description = "Run all checks (linters, etc.)"
run = "hk run check"

[tasks.fix]
description = "Run all fixers (format, generate docs, etc.)"
run = "hk run fix"

[tasks.docs]
description = "Open local API documentation in browser"
run = "pkgsite -open ."

[tasks.generate]
description = "Run all code generation tasks"
depends = ["update-docs"]
run = "go generate ./..."
